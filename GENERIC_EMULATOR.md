# Generic interface

## Synopsis
iio-emu generic <path_to_XML> "<device_id>@<file_path>" ...

## XML file
First you need to define the structure of the main device. The structure can be a conceptual one, or it can
replicate the structure of an actual device. For physical devices you can use the [xml_gen](tools/README.md)
tool for creating the XML file. The iio-emu XML is not identical to the XML generated by libiio, the difference is
that the iio-emu XML contains the attribute 'value' for all end-nodes.

## RX/TX devices
Any RX or TX device can be linked to a file from which to stream data. When calling the emulator, use the
following syntax to link a device to a file: <device_id>@<file_path>. A valid device id looks like: iio:device0.

You can create a loop-back between an RX and TX device by linking both to the same file.

|Generic TX devices do not support cyclic buffers (only streaming mode).|
| --- |

## Example
### Generic ADALM-PLUTO

1. Connect a physical Pluto to your computer and run the xml_gen for it. Save the output to an XML file.
```shell
    xml_gen ip:pluto.local > pluto.xml
```
2. Create an empty file in which the data will be stored (data.bin)
3. Start the generic emulator.  
In our example iio:device2 is cf-ad9361-dds-core-lpc (TX device) and iio:device3 is cf-ad9361-lpc (RX device).  
Both devices are linked to the same file, this means that the output of the TX device will be the input
of the RX device.
```shell
    iio-emu generic "pluto.xml" iio:device2@data.bin iio:device3@data.bin
```

Now the emulator is running, waiting for clients.
